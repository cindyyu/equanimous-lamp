!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("riot"));else if("function"==typeof define&&define.amd)define(["riot"],e);else{var r=e("object"==typeof exports?require("riot"):t.riot);for(var o in r)("object"==typeof exports?exports:t)[o]=r[o]}}(this,function(t){return function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=r(1),s=r(2),u=console&&console.error||function(){},c=function(){function t(){n(this,t),i.router=this,i.observable(this),this.interceptors=[this.processRoute.bind(this)],this.handler=new f,this.current=new a("").response,this.process=this.process.bind(this)}return t.prototype.route=function(t){this.handler=t},t.prototype.routes=function(t){this.route((new h).routes(t))},t.prototype.use=function(t){this.interceptors.push(t)},t.prototype.process=function(){var t=Array.prototype.slice.call(arguments),e=new a(t.join("/"));return this.rootContext||(this.rootContext=e),this.processRequest(e),e},t.prototype.processRequest=function(t){return this.processInterceptors(t),this.processResponse(t)},t.prototype.processResponse=function(t){if(this.isRedirect(t))return this.processRedirect(t);var e=(t.request,t.response);return e.redirectTo?void 0:(this.current=e,this.rootContext=null,this.trigger("route:updated",e),t)},t.prototype.isRedirect=function(t){return!!t.response.redirectTo},t.prototype.processRedirect=function(t){var e=t.response.redirectTo;this.rootContext.addRedirect(e),this.navigateTo(e)},t.prototype.navigateTo=function(t){i.route(t)},t.prototype.processInterceptors=function(t,e,r){var o=(e||[]).concat(this.interceptors).concat(r||[]),n=function i(){if(!t.stop){var e=o.shift(),r=t.request,n=t.response;if(e)return e(r,n,i,t)}return t};return n()},t.prototype.processRoute=function(t,e,r,o){return this.handler.process(t,e,o),r()},t.prototype.start=function(){i.route(this.process),i.route.start(),this.exec()},t.prototype.exec=function(){i.route.exec(this.process)},t}(),a=function(){function t(e){n(this,t),this.request="string"==typeof e?new m(e):e,this.response=new v(this.request),this.redirectStack=[]}return t.prototype.addRedirect=function(t){if(this.redirectStack.indexOf(t)>-1)throw new Error("Cyclic redirection to "+t+". Stack = "+this.redirectStack);this.redirectStack.push(t)},t}(),p=function(){function t(){n(this,t)}return t.prototype.matches=function(t){return!1},t.prototype.process=function(t,e){var r=this.matches(t);return r?this.routeMatch(t,e,r):this.routeMiss(t,e)},t.prototype.routeMatch=function(t,e,r){return e.add(r),!0},t.prototype.routeMiss=function(t,e){return!1},t.prototype.processRoutes=function(t,e,r){if(r&&r.length){for(var o=r.length,n=0;o>n;n++){var i=r[n];if(i.process(t,e))return!0}return!1}},t.prototype.createRequest=function(t,e){return new l(t,e)},t}(),h=function(t){function e(r){n(this,e),t.call(this,r),r=r||{},this.tag=r.tag,this.api=r.api,this.path=r.path,this.name=r.name,this.pathParameterNames=[];var o=(this.path||this.name||this.tag||"").replace(/^\//,"");this.pattern="^/?"+o.replace(/:([^\/]+)/g,function(t,e){return this.pathParameterNames.push(e),"([^/]+)"}.bind(this))+"(:?/|$)",this.regex=new RegExp(this.pattern)}return o(e,t),e.prototype.routes=function(t){var e=t.filter(function(t){return t instanceof y}),r=t.filter(function(t){return t instanceof g}),o=t.filter(function(t){return t instanceof d}),n=t.filter(function(t){return-1===e.indexOf(t)&&-1===r.indexOf(t)&&-1===o.indexOf(t)});return o.length>1&&u("Can't use more than one NotFoundRoute per route. --> "+(this.name||this.path||this.tag)),r.length>1&&u("Can't use more than one DefaultRoute per route. --> "+(this.name||this.path||this.tag)),this._routes=[].concat(e).concat(n).concat(r).concat(o),this},e.prototype.matches=function(t){var e=this.regex.exec(t.uri);if(e){var r={};for(var o in this.pathParameterNames){var n=this.pathParameterNames[o];r[n]=decodeURIComponent(e[parseInt(o,10)+1])}return{route:this,tag:this.tag,api:this.api,found:e[0],params:r}}return!1},e.prototype.routeMatch=function(e,r,o){var n=t.prototype.routeMatch.call(this,e,r,o);return this.processRoutes(e,r,o),n},e.prototype.processRoutes=function(e,r,o){return t.prototype.processRoutes.call(this,t.prototype.createRequest.call(this,e,o),r,this._routes)},e}(p),f=function(t){function e(){n(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.routeMatch=function(){return!0},e.prototype.processRoutes=function(e,r,o){return t.prototype.processRoutes.call(this,e,r,this._routes)},e}(h),l=function x(t,e){n(this,x),this.request=t,this.matcher=e,this.uri=this.request.uri.substring(e.found.length),this.parentUri=this.request.uri.substring(0,e.found.length)},d=function(t){function e(r){n(this,e),t.call(this,r),r=r||{},this.tag=r.tag,this.api=r.api}return o(e,t),e.prototype.matches=function(t){return{route:this,tag:this.tag,api:this.api,found:t.uri}},e}(p),y=function(t){function e(r){n(this,e),t.call(this,r),r=r||{},this.from=r.from,this.to=r.to,this.pattern="(^/?)"+this.from+"(/|$)",this.regex=new RegExp(this.pattern)}return o(e,t),e.prototype.process=function(t,e){var r=t.uri.replace(this.regex,"$1"+this.to+"$2");if(r!==t.uri){var o=t.parentUri||"";return e.redirectTo=o+r,!0}},e}(p),g=function(t){function e(r){n(this,e),t.call(this,r),r=r||{},this.tag=r.tag,this.api=r.api}return o(e,t),e.prototype.matches=function(t){var e=t.uri.trim();return"/"===e||""===e?{route:this,tag:this.tag,api:this.api,found:e}:void 0},e}(p),m=function b(t){n(this,b),this.uri=t},v=function(){function t(e){n(this,t),this.uri=e.uri,this.matches=[],this.params={}}return t.prototype.add=function(t){this.matches.push(t);var e=t.params;if(e)for(var r in e)e.hasOwnProperty(r)&&(this.params[r]=e[r])},t.prototype.get=function(t){return this.matches[t]},t.prototype.size=function(){return this.matches.length},t.prototype.isEmpty=function(){return this.matches.length},t}();i.tag("route","<router-content></router-content>",function(t){this.calculateLevel=function(t){var e=0;return t.parent&&(e+=this.calculateLevel(t.parent)),t.opts.__router_level&&(e+=t.opts.__router_level),t.__router_tag&&(e+=1),e}.bind(this),this.unmountTag=function(){this.instance&&this.instance.forEach(function(t){t.unmount(!0)})},this.mountTag=function(t,e){this.unmountTag(),t&&(this.root.replaceChild(document.createElement(t),this.root.children[0]),this.instance=i.mount(this.root.children[0],t,e))},this.updateRoute=function(){var t={tag:null};if(i.router&&i.router.current){var e=i.router.current;if(this.level<=e.size()){var r=e.get(this.level);if(r){var o=r.params||{},n=s(!0,{},r.api,o,{__router_level:this.level});t={tag:r.tag,api:n}}}}this.mountTag(t.tag,t.api)}.bind(this),this.__router_tag="route",this.level=this.calculateLevel(this),i.router.on("route:updated",this.updateRoute),this.on("unmount",function(){i.router.off("route:updated",this.updateRoute),this.unmountTag()}.bind(this))});var R=new c;R.Route=h,R.DefaultRoute=g,R.RedirectRoute=y,R.NotFoundRoute=d,R._={Response:v,Request:m},i.router=R,t.exports=R},function(e,r){e.exports=t},function(t,e){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,n=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},i=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var e=r.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!n)return!1;var i;for(i in t);return"undefined"==typeof i||r.call(t,i)};t.exports=function s(){var t,e,r,o,u,c,a=arguments[0],p=1,h=arguments.length,f=!1;for("boolean"==typeof a?(f=a,a=arguments[1]||{},p=2):("object"!=typeof a&&"function"!=typeof a||null==a)&&(a={});h>p;++p)if(t=arguments[p],null!=t)for(e in t)r=a[e],o=t[e],a!==o&&(f&&o&&(i(o)||(u=n(o)))?(u?(u=!1,c=r&&n(r)?r:[]):c=r&&i(r)?r:{},a[e]=s(f,c,o)):"undefined"!=typeof o&&(a[e]=o));return a}}])});
//# sourceMappingURL=router.min.js.map